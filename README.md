# 미분 기반 활성화 함수와 학습률 조정을 활용한 딥러닝 추천 모델


## 📌 프로젝트 소개

본 프로젝트는 다항함수의 도함수를 딥러닝 모델 내부에 직접 적용한 실험적 추천 모델이다.  
미분식을 활성화 함수와 학습률 조정 로직에 활용하여,  
수학적 변화율 개념이 신경망 학습 과정과 예측 결과에 어떤 영향을 미치는지를 탐구한다.  
음식 추천은 해당 구조의 동작을 검증하기 위한 예시 문제로 사용되었다.


## 🧮 수학적 배경
(이 프로젝트의 정체성)

본 프로젝트에서는 다음과 같은 다항함수를 기반으로 모델을 설계하였다.

f(x) = −2x³ − 6x² + 18x

이 함수의 도함수는 다음과 같다.

f′(x) = −6x² − 12x + 18

도함수 f′(x)는 입력값의 변화에 따른 출력값의 변화율을 나타내며,
본 프로젝트에서는 이 변화율 개념을 딥러닝 학습 과정에 직접 반영하였다.

구체적으로 f′(x)는  
(1) 커스텀 활성화 함수로 사용되어 각 층의 출력 변화를 조절하고,  
(2) 학습률 조정 계수로 활용되어 파라미터 업데이트의 민감도를 동적으로 변경하며,  
(3) 최종 예측 결과에 대한 점수 보정 요소로 사용된다.

이를 통해 미분이 단순한 이론적 계산을 넘어,
신경망 내부 동작과 의사결정 과정에 실질적으로 개입할 수 있음을 실험한다.


## 🎯 제작 목적

본 프로젝트는 수학Ⅱ 과정에서 다루는 미분 개념을 실제 문제에 적용해 보고자 하는 주제 탐구에서 출발하였다.
딥러닝 모델은 본질적으로 함수의 합성과 변환으로 구성되어 있으며,
학습 과정 또한 미분을 기반으로 한 최적화에 의존한다는 점에 주목하였다.

이에 따라 미분을 단순히 손실 함수 계산을 위한 도구로 사용하는 것이 아니라,
활성화 함수, 학습률 조정, 예측 결과 해석 등
신경망 내부 구조 전반에 직접 적용할 수 있는 가능성을 탐구하고자 하였다.

음식 이미지를 활용한 추천 문제는 이러한 아이디어를 실험적으로 검증하기 위한 예시이며,
본 접근 방식은 모델의 입력 형태와 무관하게
다양한 신경망 구조로 확장 가능성을 탐구할 수 있는 기반을 제공한다.


## 🧠 모델 구조 및 학습 방식

본 모델은 이미지 입력을 기반으로 한 합성곱 신경망(CNN) 구조를 사용하였다.
입력 이미지는 224×224 RGB 이미지로 구성되며,
합성곱 계층과 풀링 계층을 통해 특징을 추출한 후 완전연결층을 거쳐 분류를 수행한다.

모델의 핵심적인 특징은 일반적인 ReLU와 같은 활성화 함수 대신,
다항함수의 도함수 f′(x)를 커스텀 활성화 함수로 사용하였다는 점이다.
이를 통해 각 층의 출력 변화가 입력값의 변화율에 직접적으로 반응하도록 설계하였다.

학습 과정에서는 Adam 옵티마이저를 기반으로 한 커스텀 옵티마이저를 구현하여,
파라미터의 평균값에 따른 도함수 f′(x)의 크기를 학습률 조정 계수로 활용하였다.
이로써 변화율이 큰 구간에서는 더 민감한 업데이트가 이루어지도록 하였다.

최종적으로 모델의 출력 확률은 미분 기반 보정 과정을 거쳐,
단순한 분류 결과를 넘어 입력 조건에 따른 추천 점수로 활용된다.


## ✨ 주요 기능

본 프로젝트는 수학Ⅱ 과정에서 학습한 미분 개념이 딥러닝 모델 내부에서 어떤 역할을 수행하는지를
직접 설계·실험을 통해 확인하는 것을 핵심 기능으로 한다.

### 이미지 입력 기반 CNN 모델 학습 및 예측 기능

음식 이미지를 입력으로 받아 합성곱 신경망(CNN)을 통해 특징을 추출하고,
이를 바탕으로 이미지 분류 및 예측 결과를 생성한다.
이를 통해 딥러닝이 함수의 합성과 변환으로 구성된 구조임을 확인할 수 있다.

### 다항함수 미분을 활용한 사용자 정의 활성화 함수 설계

수학Ⅱ에서 다루는 다항함수와 그 미분 결과를 기반으로
활성화 함수를 직접 정의하여 모델에 적용하였다.
이를 통해 미분 결과가 출력 값의 변화율과 비선형성에
어떤 영향을 미치는지 실험적으로 분석할 수 있도록 하였다.

### 미분값에 따른 출력 변화율 관찰 및 비교

입력 값의 변화에 따른 출력 변화 양상을 관찰함으로써,
미분이 신경망에서 민감도(gradient) 정보로 작용하는 과정을
시각적·수치적으로 확인할 수 있도록 구성하였다.

### 학습 과정에서의 미분 기반 가중치 갱신 구조 확인

역전파 과정에서 미분값을 이용해 가중치가 갱신되는 흐름을 추적함으로써,
경사하강법과 미분 개념의 직접적인 연결성을 이해할 수 있도록 하였다.

### 분류 결과의 추천 형태 변환

단순한 이미지 분류 결과 출력에 그치지 않고,
예측된 음식 카테고리를 기반으로 추천 형식의 결과를 제공함으로써
실제 응용 서비스로의 확장 가능성을 고려하였다.

### 수학적 개념의 딥러닝 확장 가능성 탐구

본 기능들은 미분이 단순한 계산 도구가 아니라,
딥러닝 모델의 설계·학습·해석 전반에 활용될 수 있는
핵심 수학 개념임을 검증하기 위한 실험적 구조로 설계되었다.

## 🛠 사용 기술

본 프로젝트는 수학적 개념을 딥러닝 모델 내부에 적용하는 실험을 목표로 하였기 때문에,
모델의 구조와 학습 과정을 유연하게 설계하고 수정할 수 있는 기술 스택을 중심으로 구성되었다.

### Python

전체 프로젝트의 구현 언어로 사용되었으며,
수학적 계산, 모델 설계, 학습 로직 제어 등 핵심 기능을 담당한다.
특히 다항함수 및 미분식을 코드로 직접 구현하여
수학적 개념을 명확하게 반영할 수 있다는 점에서 적합하였다.

### PyTorch

딥러닝 모델 구현 및 학습을 위해 사용하였다.
동적 계산 그래프(Dynamic Computation Graph)를 지원하기 때문에
활성화 함수나 학습 과정에 미분 기반 로직을 직접 삽입하고 실험하기에 적합하였다.
이를 통해 미분이 역전파 과정에서 어떻게 활용되는지를 구조적으로 확인할 수 있었다.

### Convolutional Neural Network (CNN)

음식 이미지로부터 특징을 추출하기 위한 모델 구조로 사용되었다.
이미지 데이터를 다루는 과정에서
합성곱 연산과 비선형 변환이 반복적으로 적용되며,
함수의 합성과 미분 개념이 실제 모델 내부에서 어떻게 작동하는지 관찰할 수 있다.

### NumPy

다항함수, 미분식 계산 및 수치 연산을 위해 활용되었다.
모델 학습과는 독립적으로
수학적 변화율을 계산하고 비교·분석하는 실험용 도구로 사용되었다.

### Matplotlib / 시각화 도구

미분값 변화에 따른 출력 결과,
학습 과정에서의 손실 감소 양상 등을 시각적으로 확인하기 위해 사용하였다.
이를 통해 미분이 단순한 계산 결과가 아니라
모델의 학습 방향을 결정하는 핵심 요소임을 직관적으로 파악할 수 있다.

## ▶️ 실행 방법

## 📸 실행 결과 예시

아래 이미지는 본 프로젝트에서 구현한
미분 기반 딥러닝 모델의 추론 및 추천 결과 예시이다.

### 🔹 음식 이미지별 예측 점수 출력

모델은 입력된 음식 이미지에 대해 확률 예측을 수행한 뒤,
다항함수의 미분값을 기반으로 점수를 조정하여 최종 추천 점수를 산출한다.

**파스타**
미분 기반 점수: 1.69

**치킨**
미분 기반 점수: 2.05

**샐러드**
미분 기반 점수: 1.43

각 점수는 단순 분류 확률이 아니라,
모델 출력값에 미분 기반 가중 조정을 적용한 실험적 결과이다.


### 🔹 배고픔 수준 입력에 따른 추천 결과

아래는 배고픔 수준(hunger_level = 6)을 입력했을 때의 실행 결과이다.

입력된 배고픔 값은 수치적으로 변환되어 미분 함수의 입력값으로 사용된다.

해당 미분값은 예측 결과의 가중 조정 요소로 작용한다.

최종적으로 가장 높은 미분 적용 점수를 갖는 음식이 추천된다.

**추천 결과:
👉 샐러드 (미분 적용 점수: 1.43)**


이는 모델의 예측 결과가
사용자 상태 변수(배고픔 수준)와 수학적 변화율에 따라
동적으로 해석될 수 있음을 보여주는 예시이다.


### 🔹 해석적 의미


본 결과는 “정답 맞추기”를 목표로 한 분류 성능 평가가 아니라,
**미분이라는 수학적 개념이 딥러닝 추론 결과에
어떻게 개입하고 해석될 수 있는지**를 관찰하기 위한 실험 결과이다.

따라서 점수의 절대적인 크기보다는
미분 적용 전후의 상대적 변화와 해석 가능성에 중점을 둔다.


![파스타](https://github.com/CHOMINJUN-127/math-2/blob/main/%ED%8C%8C%EC%8A%A4%ED%83%80.png)

![치킨](https://github.com/CHOMINJUN-127/math-2/blob/main/%EC%B9%98%ED%82%A8.png)

![샐러-딥러닝](https://github.com/CHOMINJUN-127/math-2/blob/main/%EC%83%90%EB%9F%AC%EB%93%9C-%EB%94%A5%EB%9F%AC%EB%8B%9D.png)

![샐러드](https://github.com/CHOMINJUN-127/math-2/blob/main/%EC%83%90%EB%9F%AC%EB%93%9C.png)

## ⚠️ 주의사항 및 한계

본 프로젝트는 수학적 개념의 응용 가능성을 탐구하기 위한 실험적 성격의 구현으로,
실제 서비스 수준의 성능이나 일반화를 목표로 설계된 모델은 아님을 전제로 한다.

### 데이터 규모의 한계

사용된 음식 이미지 데이터는 수량이 매우 제한적이며,
인터넷에서 수집한 소수의 이미지를 기반으로 구성되었다.
따라서 모델의 분류 정확도나 예측 결과는
일반적인 대규모 이미지 분류 문제에 그대로 적용하기 어렵다.

### 활성화 함수의 실험적 사용

본 프로젝트에서 사용한 활성화 함수는
다항함수의 미분식을 기반으로 한 사용자 정의 함수로,
일반적으로 검증된 ReLU, Sigmoid 계열과는 특성이 다르다.
이로 인해 학습 안정성이나 수렴 속도가
특정 조건에서 불안정해질 가능성이 존재한다.

### 학습률 조정 방식의 일반성 부족

미분값을 이용한 학습률 조정 방식은
수학적 아이디어를 실험적으로 적용한 구조이며,
모든 데이터나 모델 구조에서
성능 향상을 보장하지는 않는다.

### 추천 결과의 해석적 성격

음식 추천 결과는
실제 사용자 선호 데이터를 학습한 결과가 아니라,
모델 출력과 미분 기반 가중 조정을 결합한 해석적 결과이다.
따라서 이는 정밀한 추천 시스템이 아니라
수학적 개념 적용 효과를 관찰하기 위한 예시로 이해해야 한다.

### 확장 가능성과 향후 과제

본 프로젝트는 CNN 기반 이미지 처리 문제를 중심으로 구성되었으나,
동일한 미분 기반 아이디어를
RNN이나 Transformer와 같은 순차 모델 구조에 확장하는 것은
추가적인 연구와 실험이 필요하다.


